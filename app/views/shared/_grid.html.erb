<div class="bg-white dark:bg-boxdark rounded-sm border border-stroke shadow-default dark:border-strokedark">
  <!-- Header -->
  <div class="py-6 px-4 md:px-6 xl:px-7.5 flex flex-wrap items-center justify-between gap-4">
    <div class="flex items-center gap-3">
      <h4 class="text-2xl font-semibold text-black dark:text-white">
        <%= options[:title] %>
      </h4>
      
      <% if options[:new_button] %>
        <%= link_to new_polymorphic_path(records.model), 
            class: "inline-flex items-center justify-center w-8 h-8 rounded-full bg-primary text-white hover:bg-opacity-90",
            title: "Adicionar" do %>
          <i class="fas fa-plus"></i>
        <% end %>
      <% end %>
    </div>

    <!-- Search -->
    <% if options[:search] %>
      <div class="relative">
        <%= form_tag(request.path, method: :get, class: "flex") do %>
          <%= text_field_tag :search, params[:search], 
              class: "rounded-lg border border-stroke bg-transparent py-2 pl-10 pr-4 outline-none focus:border-primary dark:border-strokedark",
              placeholder: "Buscar..." %>
          <button type="submit" class="absolute left-4 top-1/2 -translate-y-1/2">
            <svg class="fill-body hover:fill-primary dark:fill-bodydark dark:hover:fill-primary" width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M9.16666 3.33332C5.945 3.33332 3.33332 5.945 3.33332 9.16666C3.33332 12.3883 5.945 15 9.16666 15C12.3883 15 15 12.3883 15 9.16666C15 5.945 12.3883 3.33332 9.16666 3.33332Z" stroke="currentColor" />
              <path fill-rule="evenodd" clip-rule="evenodd" d="M13.2857 13.2857C13.6112 12.9603 14.1388 12.9603 14.4642 13.2857L18.0892 16.9107C18.4147 17.2362 18.4147 17.7638 18.0892 18.0892C17.7638 18.4147 17.2362 18.4147 16.9107 18.0892L13.2857 14.4642C12.9603 14.1388 12.9603 13.6112 13.2857 13.2857Z" stroke="currentColor" />
            </svg>
          </button>
        <% end %>
      </div>
    <% end %>
  </div>

  <!-- Table -->
  <div class="max-w-full overflow-x-auto">
    <table class="w-full table-auto">
      <thead>
        <tr class="bg-gray-50 dark:bg-meta-4">
          <% columns.each do |column, options| %>
            <th class="py-2 px-4 text-left min-w-[120px]">
              <%= sort_link(column.to_s, options[:label]) %>
            </th>
          <% end %>
          <% if options[:edit_button] || options[:delete_button] %>
            <th class="py-2 px-4 text-left">
              <span class="text-sm font-medium text-gray-500 uppercase">Ações</span>
            </th>
          <% end %>
        </tr>
      </thead>
      
      <tbody>
        <% records.each_with_index do |record, index| %>
          <tr class="<%= index.even? ? 'bg-white dark:bg-boxdark' : 'bg-gray-2 dark:bg-meta-4' %>">
            <% columns.each do |column, column_options| %>
              <td class="border-b border-[#eee] py-2 px-4 dark:border-strokedark">
                <% if column_options[:format] %>
                  <%= column_options[:format].call(record.send(column)) %>
                <% else %>
                  <%= record.send(column) %>
                <% end %>
              </td>
            <% end %>
            
            <% if options[:edit_button] || options[:delete_button] %>
              <td class="border-b border-[#eee] py-2 px-4 dark:border-strokedark">
                <div class="flex items-center space-x-3.5">
                  <% if options[:edit_button] %>
                    <%= link_to edit_polymorphic_path(record), 
                        class: "hover:text-primary" do %>
                          <i class="fas fa-pencil-alt"></i> 
                        <% end %>
                  <% end %>
                  
                  <% if options[:delete_button] %>
                    <button data-modal-target="deleteModal-<%= record.id %>" data-modal-toggle="deleteModal-<%= record.id %>" class="hover:text-primary" type="button">
                      <i class="fas fa-trash text-danger"></i>
                    </button>
                     <%= render 'shared/delete_modal', record: record %>
                  <% end %>
                </div>
              </td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="flex flex-wrap items-center justify-between gap-4 py-4 px-4 md:px-6 xl:px-7.5">
    <div class="flex items-center gap-4">
      <p class="text-sm text-body">
        <% if records.respond_to?(:total_count) && records.respond_to?(:offset_value) %>
          Mostrando <%= records.offset_value + 1 %> até <%= records.offset_value + records.length %> de <%= records.total_count %> registros
        <% else %>
          Mostrando <%= records.size %> registros
        <% end %>
      </p>
    </div>

    <div class="flex items-center gap-4">
      <%= paginate records %>
    </div>
  </div>
</div> 